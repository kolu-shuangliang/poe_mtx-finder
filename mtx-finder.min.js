function char_list_httpGetAsync(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(t.responseText)},t.open("GET","https://www.pathofexile.com/character-window/get-characters",!0),t.send(null)}function char_list_callback(e){var t=JSON.parse(e),n=[];for(var a in t)t.hasOwnProperty(a)&&0==t[a].league.localeCompare(selectedLeague)&&n.push(t[a].name);setTimeout(function(){character_httpGetAsync(n,0,character_callback)},1e3)}function character_httpGetAsync(e,t,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){4==a.readyState&&200==a.status&&n(a.responseText,e,t)},a.open("GET","https://www.pathofexile.com/character-window/get-items?accountName="+accountName+"&character="+e[t],!0),a.send(null)}function character_callback(e,t,n){var a=JSON.parse(e);if(0==n){var r=document.createElement("div");r.style.width="100%",r.style.height="25px",r.style.textAlign="center",r.style.fontSize="24px",r.style.borderTop="1px solid black",r.style.borderBottom="1px solid black",r.innerHTML="CHARACTERS",resultList.appendChild(r)}for(var i in a.items)if(a.items.hasOwnProperty(i)){if(a.items[i].hasOwnProperty("cosmeticMods")){var r=document.createElement("div");r.style.width="100%",r.style.minHeight="50px",r.style.overflow="auto",r.style.borderBottom="1px solid black",r.innerHTML="Found mtx [ "+a.items[i].cosmeticMods[0]+"<br />",r.innerHTML+="-- character: "+a.character.name+" || league: "+a.character.league+"<br />",r.innerHTML+="-- item: "+a.items[i].name+"<br />",r.innerHTML+="-- location: "+a.items[i].inventoryId+"<br />",document.getElementById("mtx-finder-result").appendChild(r)}for(var s in a.items[i].socketedItems)if(a.items[i].socketedItems.hasOwnProperty(s)&&a.items[i].socketedItems[s].hasOwnProperty("cosmeticMods")){var r=document.createElement("div");r.style.width="100%",r.style.minHeight="50px",r.style.overflow="auto",r.style.borderBottom="1px solid black",r.innerHTML="Found gem mtx!",r.innerHTML+="-- character: "+a.character.name+" || league: "+a.character.league+"<br />",r.innerHTML+="-- gem: "+a.items[i].socketedItems[s].typeLine+"<br />",r.innerHTML+="-- in item: "+a.items[i].name+"<br />",r.innerHTML+="-- location: "+a.items[i].inventoryId+"<br />",document.getElementById("mtx-finder-result").appendChild(r)}}n+1<t.length?setTimeout(function(){character_httpGetAsync(t,Number(n)+1,character_callback)},1e3):setTimeout(function(){stash_httpGetAsync(0,stash_callback)},1e3)}function stash_httpGetAsync(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.responseText,e)},n.open("GET","https://www.pathofexile.com/character-window/get-stash-items?accountName="+accountName+"&tabIndex="+e+"&league="+selectedLeague+"&tabs=0",!0),n.send(null)}function stash_callback(e,t){var n=JSON.parse(e);if(0==t){var a=document.createElement("div");a.style.width="100%",a.style.height="25px",a.style.borderTop="1px solid black",a.style.borderBottom="1px solid black",a.style.textAlign="center",a.style.fontSize="24px",a.innerHTML="STASH",resultList.appendChild(a)}for(var r in n.items)if(n.items.hasOwnProperty(r)){if(n.items[r].hasOwnProperty("cosmeticMods")){var a=document.createElement("div");a.style.width="100%",a.style.minHeight="50px",a.style.overflow="auto",a.style.borderBottom="1px solid black",a.innerHTML="Found mtx [ "+n.items[r].cosmeticMods[0]+"<br />",a.innerHTML+="-- In stash nro: "+t+"<br />",a.innerHTML+="-- Item: "+n.items[r].name+" "+n.items[r].cosmeticMods[0]+"<br />",a.innerHTML+="-- Position: [ from left: "+(Number(n.items[r].x)+1)+" ] || [ from top: "+(Number(n.items[r].y)+1)+"]<br />",document.getElementById("mtx-finder-result").appendChild(a)}for(var i in n.items[r].socketedItems)if(n.items[r].socketedItems.hasOwnProperty(i)&&n.items[r].socketedItems[i].hasOwnProperty("cosmeticMods")){var a=document.createElement("div");a.style.width="100%",a.style.minHeight="50px",a.style.overflow="auto",a.style.borderBottom="1px solid black",a.innerHTML="Found gem mtx!",a.innerHTML+="-- gem: "+n.items[r].socketedItems[i].typeLine+"<br />",a.innerHTML+="-- In stash nro: "+t+"<br />",a.innerHTML+="-- in item: "+n.items[r].name+"<br />",a.innerHTML+="-- Position: [ from left: "+(Number(n.items[r].x)+1)+" ] || [ from top: "+(Number(n.items[r].y)+1)+"]<br />",document.getElementById("mtx-finder-result").appendChild(a)}}t<Number(n.numTabs)-1&&setTimeout(function(){stash_httpGetAsync(Number(t)+1,stash_callback)},1e3)}var accountName="account",selectedLeague="Standard",leagueList=["Standard","Hardcore","Perandus","Hardcore Perandus"],container=document.createElement("div");container.style.position="absolute",container.style.top="100px",container.style.left=window.innerWidth/2-400+"px",container.style.width="800px",container.style.minHeight="800px",container.style.overflow="auto",container.style.backgroundColor="white",container.style.zIndex="9999",document.body.appendChild(container);var nameContainer=document.createElement("div");nameContainer.style.width="100%",nameContainer.style.height="50px",container.appendChild(nameContainer);var nameSpan=document.createElement("span");nameSpan.style.width="20%",nameSpan.style.cssFloat="left",nameSpan.innerHTML="Account Name: ",nameContainer.appendChild(nameSpan);var nameInput=document.createElement("input");nameInput.type="text",nameInput.id="mtx-finder-name",nameInput.style.width="70%",nameInput.style.cssFloat="right",nameContainer.appendChild(nameInput);var leagueContainer=document.createElement("div");leagueContainer.style.width="100%",leagueContainer.style.height="50px",container.appendChild(leagueContainer);var leagueSpan=document.createElement("span");leagueSpan.style.width="20%",leagueSpan.style.cssFloat="left",leagueSpan.innerHTML="Select League: ",leagueContainer.appendChild(leagueSpan);var leagueSelector=document.createElement("select");leagueSelector.id="mtx-finder-league",leagueSelector.style.width="70%",leagueSelector.style.cssFloat="right",leagueContainer.appendChild(leagueSelector);for(var x=0;x<leagueList.length;x++){var tempElement=document.createElement("option");tempElement.value=leagueList[x],tempElement.text=leagueList[x],leagueSelector.appendChild(tempElement)}var searchButton=document.createElement("button");searchButton.style.width="100%",searchButton.style.height="25px",searchButton.innerHTML="Search",container.appendChild(searchButton);var resultList=document.createElement("div");resultList.style.width="100%",resultList.style.minHeight="20px",resultList.style.overflow="auto",resultList.id="mtx-finder-result",container.appendChild(resultList),searchButton.addEventListener("click",function(){var e=document.createElement("div");e.style.width="100%",e.style.height="25px",e.style.textAlign="center",e.style.fontSize="24px",e.innerHTML="Search Started!",resultList.appendChild(e),accountName=document.getElementById("mtx-finder-name").value,selectedLeague=document.getElementById("mtx-finder-league").value,setTimeout(function(){char_list_httpGetAsync(char_list_callback)},1e3)},!1);